<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Siteleaf, http://siteleaf.com" />

<title>Publishing via the API</title>
<meta name="description" content="For the last week publishing in the Siteleaf interface has been powered by our API. This has been a requested feature by some of our users and ourselves. Its...">

<!-- Twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Nullam id dolor id nibh ultricies vehicula ut id elit.">
<meta name="twitter:title" content="Inside Retail">
<meta name="twitter:description" content="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Nullam id dolor id nibh ultricies vehicula ut id elit.">
<meta name="twitter:creator" content="https://twitter.com/insideretail">
<meta name="twitter:image:src" content="http://aqualis.co/assets/img/meta/meta-image.png">

<!-- Open Graph -->
<meta property="og:title" content="Publishing via the API" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_GB" />
<meta property="og:url" content="/posts/publishing-via-the-api/" />
<meta property="og:image" content="http://aqualis.co/assets/img/meta/meta-image.png" />
<meta property="og:description" content="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Nullam id dolor id nibh ultricies vehicula ut id elit." />
<meta property="og:site_name" content="Inside Retail" />

<!-- Icons -->
<link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/assets/icons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/assets/icons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/assets/icons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/assets/icons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/assets/icons/manifest.json">
<link rel="mask-icon" href="/assets/icons/safari-pinned-tab.svg" color="#000000">
<link rel="shortcut icon" href="/assets/icons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/assets/icons/mstile-144x144.png">
<meta name="msapplication-config" content="/assets/icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" type="text/css" href="/assets/css/app.css">
		
<link rel="canonical" href="/posts/publishing-via-the-api/">
<link rel="alternate" type="application/rss+xml" title="Inside Retail" href="/feed.xml">

<link rel="stylesheet" href="https://i.icomoon.io/public/0d0b2f3d01/InsideRetail/style-svg.css">
<script defer src="https://i.icomoon.io/public/0d0b2f3d01/InsideRetail/svgxuse.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80072725-1', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body>
	
<!-- Navigation -->
<div class="top">
<div class="top-bar">
  <div class="top-bar-left">
    <ul class="menu">
      <li><a href="/" class="header__home"><img src="/assets/img/layout/logo.svg" class="header__logo" alt="Inside Retail" /></a></li>
	  
	  
	  
      <li>
        <a href="/about/" class="">About</a>
      </li>
      
      <li>
        <a href="/setting-up/" class="">Setting Up</a>
      </li>
      
      <li>
        <a href="/trading-and-hiring/" class="">Trading & Hiring</a>
      </li>
      
      <li>
        <a href="/expanding/" class="">Expanding</a>
      </li>
      
      <li>
        <a href="/enhancing-business/" class="">Enhancing Business</a>
      </li>
      
      
    </ul>
  </div>
  <div class="top-bar-right">
    <ul class="menu">
      <li class="menu-text">Inside Retail</li>
    </ul>
  </div>
</div>
</div>
<!-- End Navigation -->
	
<!-- Content -->
<section class="content">


<article class="article">
  
  
  <section class="article__meta">
    
      <ul class="article__tags">
        
          
          
        
          
          
        
          
          
        
      </ul>
    
    
    <time class="article__date" datetime="2015-06-24T15:10:00+00:00">2015-06-24 15:10:00 +0000</time>
    
  </section>
  
  <section class="article__content">
    
      
        <p class="note">This post refers to a legacy version of Siteleaf.</p>
      
    

    

    
      <p>For the last week publishing in the Siteleaf interface has been powered by our API. This has been a requested feature by some of our users and ourselves. Its behavior is bit different than some of our other API endpoints, so letâ€™s go over it.</p>

<p>To initiate a publish, make an authenticated <code class="highlighter-rouge">POST</code> request to the <code class="highlighter-rouge">/sites/:id/publish</code> endpoint.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl -u <span class="s2">"</span><span class="nv">$API_KEY</span><span class="s2">:</span><span class="nv">$API_SECRET</span><span class="s2">"</span> -X POST <span class="se">\</span>
  http://api.siteleaf.com/v1/sites/<span class="nv">$SITE_ID</span>/publish

<span class="o">{</span><span class="s2">"job_id"</span>:<span class="s2">"e79af12c79ccd8866902d3dd"</span><span class="o">}</span> 
</code></pre>
</div>

<p>This triggers a publish and immediately returns a job ID (or returns an already running job ID if one exists). You can stop here if youâ€™d like and Siteleaf will happily chug away in the background.</p>

<p>But the fun doesnâ€™t stop there. You can optionally check in on publish progress using your <code class="highlighter-rouge">job_id</code> from above by making an authenticated <code class="highlighter-rouge">GET</code> request to the new <code class="highlighter-rouge">/jobs/:id</code> endpoint.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl -u <span class="s2">"</span><span class="nv">$API_KEY</span><span class="s2">:</span><span class="nv">$API_SECRET</span><span class="s2">"</span> <span class="se">\</span>
  http://api.siteleaf.com/api/v1/jobs/e79af12c79ccd8866902d3dd

event:publish
data:<span class="o">{</span><span class="s2">"status"</span>:<span class="s2">"working"</span>,<span class="s2">"message"</span>:<span class="s2">"Checking... /home"</span>,<span class="s2">"updated_at"</span>:<span class="s2">"1435159120"</span><span class="o">}</span>

<span class="o">[</span>etcâ€¦]

event:publish
data:<span class="o">{</span><span class="s2">"status"</span>:<span class="s2">"complete"</span>,<span class="s2">"message"</span>:<span class="s2">"Published"</span>,<span class="s2">"updated_at"</span>:<span class="s2">"1435159121"</span><span class="o">}</span>
</code></pre>
</div>

<p>This endpoint, unlike our others, consistently returns <a href="https://en.wikipedia.org/wiki/Server-sent_events">Server Sent Events</a> (SSE) instead of JSON documents (including  errors). The <code class="highlighter-rouge">data</code> field is JSON encoded however. SSE is supported in all modern browsers and there are client libraries in a number of programming languages.</p>

<p>Additionally, job IDâ€™s are kept for at least 30 minutes after completion so you can check in on a publish immediately or wait a bit.</p>

<p>Canâ€™t wait to see what uses you come up with!</p>

<h3 id="publishing-from-the-gem">Publishing from the gem</h3>

<p>First install the latest gem (<a href="https://rubygems.org/gems/siteleaf"><code class="highlighter-rouge">0.9.23</code></a> as of writing)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>gem install siteleaf
</code></pre>
</div>

<p>And thenâ€¦</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>siteleaf publish
Fetching inventory...
Compiling...
<span class="o">[</span>etcâ€¦]
Published
<span class="gp">=&gt; </span>Publish completed.
</code></pre>
</div>

<p>Or if you donâ€™t care about progress, you can use either of the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>siteleaf publish -q
<span class="gp">$ </span>siteleaf publish --quiet

<span class="gp">=&gt; </span>Publish queued.
</code></pre>
</div>

<p>ðŸŽ‰ðŸŽ‰</p>

    
    
  </section>
</article>



</section>
<!-- End Content -->
	
<!-- Footer -->
<footer>
<!-- Footer Top -->
<div class="row expanded">
  <div class="small-6 columns">
  <ul class="menu">
	<li><a href="/" class="header__home"><img src="/assets/img/layout/logo.svg" class="header__logo" alt="Inside Retail" /></a></li>
  </ul>
  </div>
</div>
<!-- End Footer Top -->

<!-- Footer Bottom -->
<div class="row expanded">
  <div class="small-6 columns">
  <ul class="menu">
	<li><a href="#">Â© 2016 i2i Events Group</a></li>
  </ul>
  </div>
  <div class="small-6 columns">
  <ul class="menu align-right">
	<li><a href="#"><svg class="icon icon-linkedin2"><use xlink:href="#icon-linkedin2"></use></svg></a></li>
	<li><a href="#"><svg class="icon icon-google-plus"><use xlink:href="#icon-google-plus"></use></svg></a></li>
    <li><a href="#"><svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg></a></li>
    <li><a href="#"><svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg></a></li>
    <li class="menu-text">Connect</li>
  </ul>
  </div>
</div>
<!-- End Footer Bottom -->
</footer>
<!-- End Footer -->

</body>
<script src="/assets/js/min/app-min.js"></script>
</html>
